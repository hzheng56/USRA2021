CREATE SCHEMA IF NOT EXISTS proj_cov19;

USE proj_cov19;

CREATE TABLE IF NOT EXISTS 2021Jun08 (
    COV_ID INTEGER NOT NULL, COV_REG INTEGER NOT NULL, COV_EW INTEGER NOT NULL, COV_EWG INTEGER NOT NULL,
    COV_EY INTEGER NOT NULL, COV_GDR INTEGER NOT NULL, COV_AGR INTEGER NOT NULL, COV_OCC INTEGER NOT NULL,
    COV_ACM INTEGER NOT NULL, COV_OW INTEGER NOT NULL, COV_OY INTEGER NOT NULL, COV_HSP INTEGER NOT NULL,
    COV_RSV INTEGER NOT NULL, COV_RW INTEGER NOT NULL, COV_RY INTEGER NOT NULL, COV_DTH INTEGER NOT NULL,
    COV_TRM INTEGER NOT NULL, PRIMARY KEY (COV_ID)
);

LOAD DATA INFILE 'COVID19-eng-2021Jun08.csv' REPLACE INTO TABLE proj_cov19.`2021Jun08` FIELDS TERMINATED BY ',' IGNORE 1 LINES;

# create summaries
SELECT COV_GDR, COV_AGR, COUNT(*) FROM proj_cov19.`2021Jun08_AC_icuY_dthY` GROUP BY COV_GDR, COV_AGR;
SELECT COV_GDR, COV_AGR, COUNT(*) FROM proj_cov19.`2021Jun08_AC_icuN_dthY` GROUP BY COV_GDR, COV_AGR;
SELECT COV_GDR, COV_AGR, COUNT(*) FROM proj_cov19.`2021Jun08_AC_hpN_dthY` GROUP BY COV_GDR, COV_AGR;

# delete all tables
SELECT CONCAT('DROP TABLE IF EXISTS `', TABLE_NAME, '`;') FROM information_schema.tables WHERE TABLE_SCHEMA = 'proj_cov19';
